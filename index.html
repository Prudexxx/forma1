<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Создание договора</title>
  <!-- Подключение библиотеки html-docx-js -->
  <script src="https://cdn.jsdelivr.net/npm/html-docx-js/dist/html-docx.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/file-saver/dist/FileSaver.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      transition: background-color 0.3s ease, font-size 0.3s ease;

      margin: 20px;
    }
    h1 {
      text-align: center;
     
    }
    form {
      max-width: 700px;
      margin: auto;
    }
    label {
      margin-bottom: 30px;
      display: block;
      margin-top: 10px;
    }
    input, textarea, select {
       margin-top: 10px;
      width: 100%;
      padding: 8px;
      box-sizing: border-box;
    }
    button {
      margin-top: 20px;
      padding: 12px 24px;
      font-size: 16px;
      cursor: pointer;
    }

  </style>
</head>
<body>
<h1>Форма для создания договора</h1>
<form id="contractForm">
  <label>
    Выберите наименование услуги:
    <select id="serviceSelect">
      <option value="">--Выберите--</option>
      <option value="Песок">Песок</option>
      <option value="ПГС">ПГС</option>
      <option value="Щебень">Щебень</option>
      <option value="Чернозем">Чернозем</option>
      <option value="Навоз">Навоз</option>
      <option value="Перегной">Перегной</option>
      <option value="Дрова 1складной кубо метр=Д*Ш*В">Дрова 1складной кубо метр=Д*Ш*В</option>
      <option value="Дрова 1 навальный куб дров=0,7 складного куба">Дрова 1 навальный куб дров=0,7 складного куба</option>
    </select>
  </label>
  <label>
    Дата (день месяц год):
    <input type="date" id="date" required>
  </label>
  <label>
    Количество:
    <input type="number" id="quantity" min="0" required>
  </label>
  <label>
    Единица измерения:
    <select id="unit" required>
      <option value="т">т</option>
      <option value="м3">м3</option>
    </select>
  </label>
  <label>
    Сумма (руб):
    <input type="number" id="amount" min="0" required>
  </label>
  <label>
    Заказчик имя:
    <input type="text" id="customer" placeholder="Иванов И И" required>
  </label>
  <label>
    Адрес:
    <input type="text" id="address" placeholder="Новотрактовая, 13" required>
  </label>
  <label>
    Телефон заказчика:
    <input type="tel" id="customerPhone" placeholder="8-00-00-00-00" required>
  </label>
  <button type="button" onclick="generateAndDownload()">Создать договор</button>
</form>

<script>
function generateAndDownload() {
  // Получение данных из формы
  const serviceSelect = document.getElementById('serviceSelect');
  const selectedService = serviceSelect.value.trim();
  const serviceName = selectedService; // Используем выбранное значение
  const dateInput = document.getElementById('date').value;
  const quantity = document.getElementById('quantity').value;
  const unit = document.getElementById('unit').value;
  const amount = document.getElementById('amount').value;
  const customer = document.getElementById('customer').value.trim();
  const address = document.getElementById('address').value.trim();
  const customerPhone = document.getElementById('customerPhone').value.trim();

  // Форматирование даты
  const dateObj = new Date(dateInput);
  const options = { day: 'numeric', month: 'long', year: 'numeric' };
  const formattedDate = dateObj.toLocaleDateString('ru-RU', options);

  const htmlContent = `
<h2 style="text-align:center;">АКТ №     1     ОТ       ${dateObj.getDate()}  ${dateObj.toLocaleString('ru-RU', { month: 'long' })}  ${dateObj.getFullYear()}г.</h2>
<p>Исполнитель ИП Михайлов Александр Андреевич <br>
ИНН 590613985887 ОГРНИП 305590609000010 тел.271-81-41</p>
<table style="width:100%; border-collapse: collapse; margin-top:10px;">
<tr>
  <td style="width:50%; vertical-align: top;">
    <p>Заказчик: ${customer}      ${address}</p>
  </td>
  <td style="width:50%; vertical-align: top; text-align:right;">
    <p>Телефон заказчика: ${customerPhone}</p>
  </td>
</tr>
</table>

<table style="width:100%; border-collapse: collapse; margin-top:10px;" border="1" cellpadding="5" cellspacing="0">
<tr>
  <th>№</th>
  <th>Наименование</th>
  <th>Кол-во</th>
  <th>Ед.</th>
  <th>Сумма, руб.</th>
</tr>
<tr>
  <td>1</td>
  <td>${serviceName}</td>
  <td>${quantity}</td>
  <td>${unit}</td>
  <td>${amount}</td>
</tr>
</table>

<table style="width:100%; border-collapse: collapse; margin-top:10px;" border="0" cellpadding="5" cellspacing="0">
<tr>
  <td style="width:50%;"></td>
  <td style="width:50%; text-align:right;">Сумма с учетом скидки при предоставлении карты №  ____  5%</td>
</tr>
<tr>
  <td style="width:50%;"></td>
  <td style="width:50%; text-align:right;">Итого: <u> ${amount} </u></td>
</tr>
<tr>
  <td style="width:50%;"></td>
  <td style="width:50%; text-align:right;">Без НДС  <u> ${amount} </u></td>
</tr>
</table>

<p>Всего оказано услуг на сумму: <u> ${amount} </u> руб.</p>
<p>Вышеперечисленные услуги выполнены полностью и в срок. Заказчик претензий по объему, качеству и срокам оказания услуг не имеет.</p>

<p>ВОДИТЕЛЬ ____________________________</p>
<p>ИСПОЛНИТЕЛЬ ЛОГИСТ ____________________________</p>
<p>________________________________________</p>
<p>ЗАКАЗЧИК ____________________________</p>

<p>*Просим ответить на вопрос ниже:</p>
<p>Откуда узнали информацию о нашей компании?</p>
<p>__________________________________________________</p>

<p>Перевод  8- 908-271-81-41 Александр Андреевич М.( Сбербанк)</p>
`;

  // Генерация файла Word
  const blob = htmlDocx.asBlob(htmlContent);
  saveAs(blob, `Акт_${formattedDate}.docx`);
}
</script>
  <script>
function applyResponsiveStyles() {
  if (window.innerWidth <= 500) {
  
    document.body.style.margin = '10px';
    document.body.style.fontSize = '35px';

    // Можно дополнительно изменить стили элементов
    const headers = document.querySelectorAll('h1');
    headers.forEach(h => h.style.fontSize = '35px');

    const labels = document.querySelectorAll('label');
    labels.forEach(l => {
      l.style.marginBottom = '20px';
      l.style.fontSize = '45px';
    });

    const inputs = document.querySelectorAll('input, select');
    inputs.forEach(i => {
      i.style.fontSize = '40px';
      i.style.padding = '16px';
    });

    const buttons = document.querySelectorAll('button');
    buttons.forEach(b => {
      b.style.fontSize = '40px';
      b.style.padding = '18px 24px';
    });
  } else {
    // становить исходные стили, если нужно
    document.body.style.backgroundColor = '';
    document.body.style.margin = '';
    document.body.style.fontSize = '';
    // Аналогично для других элементов
  }
}

// Вызов при загрузке и изменении размера окна
window.addEventListener('load', applyResponsiveStyles);
window.addEventListener('resize', applyResponsiveStyles);
</script>
</body>
</html>
